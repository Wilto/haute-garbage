---
layout: layouts/base.njk
templateClass: tmpl-post
---

{% macro respimg(path, img, sizes, alt, capt) %}
<img 
	sizes="{{ sizes }}"
	srcset="
		{{ path }}{{ img }}-1.jpg 320w,
		{{ path }}{{ img }}-2.jpg 450w,
		{{ path }}{{ img }}-3.jpg 640w,
		{{ path }}{{ img }}-4.jpg 820w,
		{{ path }}{{ img }}-5.jpg 1024w"
	src="{{ path }}{{ img }}-4.jpg" 
	{% if capt %}
	aria-describedby="capt-1"
	{% endif %}
	alt="{{ alt }}">
{% endmacro %}

{% macro featrespimg(path, img, sizes, alt, capt) %}
<img 
	src="{{ path }}feat/{{ featimg }}-7.jpg" 
	{% if capt %}
	aria-describedby="capt-1"
	{% endif %}
	alt="{{ alt }}">
{% endmacro %}

<div class="col">
	{% if featimg %}
	<figure class="featured-image">
		{{ featrespimg('/img/', img, '(min-width: 560px) 38vw, 100vw', alt, capt ) }}
		{% if capt %}
		<figcaption id="capt-1" class="caption">
			{{capt | safe}}
		</figcaption>
		{% endif %}
	</figure>
	{% endif %}
	<div class="intro">
		<header role="banner" class="recipeheader">
			<h2 class="recipe-hed" itemprop="name">{{ title }}</h2>
			<span class="meta"></span>
		</header>

		{% if feat_img.img %}
		<figure class="feat-thumb">
			{% cloudrespimg
				feat_img.img,
				feat_img.alt,
				"(min-width: 1260px) 370px, (min-width: 720px) calc(28.46vw + 17px), (min-width: 560px) 37.86vw, 99.58vw"
			%}
			{% if feat_img.capt  %}
			<figcaption id="capt-1" class="caption">
				{{ feat_img.capt | safe }}
			</figcaption>
			{% endif %}
		</figure>
		{% endif %}

		{% if video %}
		<figure aria-describedby="pagevid">
			<video controls>
				<source src="/_assets/media/{{video}}.mp4" type="video/mp4">
				<track kind="captions" src="/_assets/media/{{video}}.vtt">
				Sorry, Iâ€™m having trouble loading this video.
			</video>
			{% if capt %}
			<figcaption id="pagevid" class="caption">
				{{ capt | safe}}
			</figcaption>
			{% endif %}
		</figure>
		{% endif %}

		{% if lede %}
		<p class="lede" itemprop="description">{{ lede | safe }}</p>
		{% endif %}

		{{ layoutContent | safe }}

		{% if related %}
		<div class="related-articles">
			<h3 class="related-hed">Related Recipe{% if related.length > 1 %}s{% endif %}:</h3>
			{% for relation in related %}
				{% set rels = collections.recipes | relatedFilter( relation ) %}
				{% for rel in rels %}
				<article class="related-article">
					{% if rel.data.img %}
						<a href="{{ rel.data.page.url }}">
						{{ respimg('/img/', rel.data.img, '10em', rel.data.alt )  }}
						</a>
					{% endif %}
					{% if rel.data.feat_img.img %}
					{% cloudrespimg
						feat_img.img,
						feat_img.alt,
						"10em"
					%}
					<img src="{{ feat_img.img }}" alt="{{ feat_img.alt }}">
					{% endif %}
					<div>
						<h4 class="rel-hed"><a href="{{ rel.data.page.url }}">{{ rel.data.title }}</a></h4>
						<p class="rel-lede">{{ rel.data.subhed | safe }}</p>
					</dio>
				</article>
				{% endfor %}
			{% endfor %}
		</div>
{% endif %}

	</div>
</div>
